
<!DOCTYPE html>
<html lang="es">
<head>
 <meta charset="utf-8"/>
  <title>Moda & Estilo</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <!-- Estilos y fuentes -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet"/>
  <link rel="icon" href="favicon.ico">
  <link href="style.css" rel="stylesheet"/>

 <style>


:root {
  --color-principal: #000000;
  --color-secundario: #ffffff;
  --color-negro: #000000;
  --color-texto: #090909;
  --gris-claro: #f2f2f2;
  --borde-radius: 12px;
  --trans: all 0.3s ease;
  --sombra-suave: 0 4px 12px rgba(0, 0, 0, 0.1);
  --verde: #2eb719;
--verde-hover: #3ddc84;
--gris-hover: #8b99a5;
--fondo-buscador: #eae0e6;
--borde-input: #a3a0a0;
--sombra-botones: 0 6px 18px rgba(255, 255, 255, 0.2);

}

html {
  scroll-behavior: smooth;
}


/* ===================================
  ocultar descuento extra      borrar para mostrar descuento extra
=================================== */
.descuento-tiempo {
  display: none;
}
.descuento-activa {
  display: block;
}


/* ===================================
   üîÑ RESET GENERAL
=================================== */
*, *::before, *::after {
  box-sizing: border-box;
}

html, body {
  margin: 0;
  padding: 6px 0 0 0;
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: var(--color-secundario);
  color: #000000dd;
}

body.dark-mode {
  background-color: #121212;
  color: #f0f0f0;
}

/* ===================================
   üìê LAYOUT BASE
=================================== */
#inicio, #quienes-somos, #footer {
  scroll-margin-top: 120px;
  padding-top: 2rem;
}

/* ===================================
   üß≠ ENCABEZADO Y NAVEGACI√ìN
=================================== */
header {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 70px;
  background: black;
  color: white;
  z-index: 1000;
  border-radius: 0 0 20px 20px;
  box-shadow: var(--sombra-suave);
}

header h1 {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  font-family: 'Playfair Display', serif;
  font-size: 2rem;
  margin: 0;
  line-height: 1;
  text-align: center;
  max-width: 90%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.barra-navegacion {
  position: sticky;
  top: 52px;
  z-index: 999;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.01rem;
  background-color: #f5f3f3;
  padding: 0.8rem 1rem;
  border-bottom: 2px solid #000;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}

.barra-navegacion a {
  color: #000;
  background-color: #ffffff;
  border: 0.5px solid #000;
  padding: 0.1rem 0.2rem;
  border-radius: 8px;
  font-weight: 600;
  font-size: 0.8rem;
  text-decoration: none;
  transition: var(--trans);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
}

.barra-navegacion a:hover {
  background-color: #ecf0ed;
  color: #000;
  border-color: #000000;
}

/* ===================================
   üîç BUSCADOR
=================================== */
#bloque-buscador {
  width: 100%;
  display: flex;
  justify-content: center;
  padding: 80px 0 0.5rem;
}

.contenedor-buscador {
  position: relative;
  width: 90%;
  max-width: 400px;
}

#buscadorProductos {
  width: 100%;
  padding: 0.7rem 1rem 0.7rem 2.5rem;
  font-size: 1rem;
  border-radius: 12px;
  border: 2px solid #000000;
  background-color: #e9e7e8;
  color: rgb(0, 0, 0);
  outline: none;
}

#buscadorProductos::placeholder {
  color: white;
}

.icono-lupa {
  position: absolute;
  left: 0.9rem;
  top: 50%;
  transform: translateY(-50%);
  color: white;
  font-size: 1rem;
  pointer-events: none;
}


/* ===================================
   üõç PRODUCTOS
=================================== */
/* üì¶ Contenedor de producto */
.producto {
  background-color: #fff;
  border-radius: 20px;
  box-shadow: var(--sombra-suave);
  max-width: 480px;
  padding: 0.8rem;
  margin: 2rem auto;
  text-align: center;
  transition: var(--trans);
}

.producto:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
}

.contenedor-img {
  width: 100%;
  aspect-ratio: 1 / 1;
  overflow: hidden;
  border-radius: 12px;
  background-color: #f8f8f8;
  display: flex;
  align-items: center;
  justify-content: center;
  max-width: 100%; /* üîß importante en m√≥viles */
}

.contenedor-img img.main-img {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  object-fit: contain;
  display: block;
}



@media (max-width: 600px) {
  .contenedor-img {
    width: 100vw;        /* ocupar todo el ancho de pantalla */
    max-width: 100%;
    aspect-ratio: 1 / 1; /* mantiene forma cuadrada */
    margin: 0 auto;
  }
}



/* üß† Tipograf√≠a y estilos del producto */
.producto h2 {
  font-size: clamp(1.2rem, 2vw, 1.4rem);
  margin: 0.5rem 0;
  color: #000;
  font-weight: bold;
}

.producto p {
  font-size: 1rem;
  color: #090909;
  margin: 0.5rem 0;
}

.producto strong {
  color: #970000;
  font-size: 1.15rem;
}




/* ===================================
   üè∑ DESCRIPCI√ìN DEL PRODUCTO
   =================================== */

/* Contenedor principal de la descripci√≥n */
.descripcion-expandible {
  margin: 0.5rem 0;
}

/* Texto de la descripci√≥n oculto por defecto */
.descripcion-texto {
  font-size: 0.9rem;
  line-height: 1.4;
  color: #060606;
  margin-top: 0.5rem;
  display: none;
}

/* Clase que se agrega para mostrar el texto con animaci√≥n */
.descripcion-texto.mostrar {
  display: block;
  animation: fadeIn 0.3s ease-in-out;
}

/* Bot√≥n para mostrar/ocultar descripci√≥n */
.btn-ver-descripcion {
  background: none;
  border: none;
  color: #000000;
  cursor: pointer;
  font-size: 0.85rem;
  padding: 0;
}

.btn-ver-descripcion:hover {
  text-decoration: underline;
}

/* Animaci√≥n para mostrar el texto suavemente */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}


/* ===================================
   üé® CARRUSEL DE COLORES Y TALLAS
=================================== */
.carrusel-scroll {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  gap: 0.5rem;
  padding: 0.5rem 0;
  justify-content: center;
  -webkit-overflow-scrolling: touch;
}

.carrusel-scroll::-webkit-scrollbar {
  display: none;
}

.carrusel-scroll > * {
  flex: 0 0 calc(100% / 3.2);
  max-width: 100px;
  scroll-snap-align: center;
  transform: scale(0.9);
  transition: transform 0.3s ease, opacity 0.3s ease;
  text-align: center;
}

.carrusel-scroll > *.active {
  background: #fff;
  border: 2px solid #000;
  transform: scale(1.12);
  box-shadow: 0 0 10px #000;
}

.color-item,
.talla-item {
  display: inline-block;
  padding: 0.7rem 1.4rem;
  margin: 0.4rem 0;
  border-radius: 14px;
  font-weight: bold;
  font-size: 1rem;
  color: #000;
  background: linear-gradient(135deg, #e0e0e0, #ffffff);
  border: 2px solid #7d7777;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  transition: var(--trans);
  white-space: nowrap;
}

.color-item:hover,
.talla-item:hover {
  transform: scale(1.12);
  background: linear-gradient(135deg, #d8d8d8, #e6e6e6);
  box-shadow: 0 6px 16px rgba(125, 124, 124, 0.25);
  cursor: pointer;
}

.color-item.active,
.talla-item.active {
  background: #fff;
  border: 2px solid #81fe90;
  transform: scale(1.12);
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.3);
}

.imagenes-carrusel {
  display: none;
  height: 0;
  visibility: hidden;
  opacity: 0;
  pointer-events: none;
}


/* ===================================
   üîò BOTONES
=================================== */
button,
.btn-verde,
.btn-gris,
.btn-agregar {
  padding: 0.9rem 1.2rem;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 10px;
  border: 2px solid #000;
  transition: var(--trans);
  cursor: pointer;
}

button {
  background-color: var(--color-principal);
  color: #fff;
  width: 100%;
  max-width: 320px;
}

button:hover {
  background-color: var(--color-secundario);
  color: #000;
  transform: scale(1.02);
}

.btn-verde {
  background-color: #2eb719;
  color: #fff;
}

.btn-verde:hover {
  background-color: #3ddc84;
  color: #000;
}

.btn-gris {
  background-color: #6c757d;
  color: #fff;
}

.btn-gris:hover {
  background-color: #8b99a5;
  color: #000;
}

.btn-agregar {
  display: block;
  margin: 1.2rem auto 0;
  background: #000;
  color: #ffffff;  /*blanco*/
  border-radius: var(--borde-radius);

  max-width: 280px;
  box-shadow: 0 6px 18px rgba(255, 255, 255, 0.2);
}

.btn-agregar:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 20px #fff;
  color: #000000;
}

/* ===================================
   üõí CARRITO
=================================== */

.icono-carrito-fijo {
  position: fixed;
  top: 56px;
  right: 5px;
  width: 47px;
  height: 47px;
  font-size: 1.6rem;
  background-color: #000000;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1001;
  box-shadow: var(--sombra-suave);
  border: none;
  cursor: pointer;
}

.icono-carrito-fijo.ver-carrito:hover {
  background-color: #313030;
  color: #fff;
}

.icono-carrito-fijo.ocultar-carrito:hover {
  background-color: #76f526;
  color: #131aeb;
}

/* üßæ Panel del carrito */
#bloqueCarrito.container {
  position: fixed;
  top: 0;
  right: 0;
  width: 320px;
  height: 100vh;
  background-color: #fffcfc;
  padding: 1.5rem;
  z-index: 9999;
  box-shadow: -4px 0 12px rgba(0, 0, 0, 0.2);
  overflow-y: auto;
  transition: transform 0.3s ease;
  transform: translateX(100%); /* Oculto por defecto */
}

/* Mostrar carrito */
#bloqueCarrito.container.mostrar {
  transform: translateX(0);
}

/* Ocultar carrito completamente */
#bloqueCarrito.container.oculto {
  display: none;
}

.cerrar-carrito {
  position: absolute;
  top: 15px;
  right: 15px;
  font-size: 1.5rem;
  cursor: pointer;
  color: #000;
  z-index: 10000;
}

.cerrar-carrito:hover {
  color: #000;
}

/* Total del carrito */
.total-carrito {
  text-align: right;
  font-size: 1.2rem;
  margin-top: 1rem;
  color: #333;
}

.total-carrito span {
  font-weight: bold;
  color: #28a745;
}

/* Estilos para los items dentro del carrito */
.item-carrito-elegante .info-superior {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.item-carrito-elegante h4 {
  margin: 0;
  font-size: 1.1rem;
}

.item-carrito-elegante p {
  font-size: 1rem;
  max-width: 100%;
  white-space: nowrap;
  overflow: visible;
  text-overflow: unset;
}

.item-carrito-elegante strong {
  display: inline-block;
  font-weight: bold;
  max-width: 100%;
}

/* Correcci√≥n para pantallas peque√±as */
@media (max-width: 480px) {
  .item-carrito-elegante p {
    white-space: normal;
    word-break: break-word;
    font-size: 1.1rem;
  }
}

.opciones-cantidad {
  margin: 4px 0;
  font-size: 0.85rem;
  display: flex;
  align-items: center;
  gap: 6px;
}

.opciones-cantidad label {
  font-weight: 500;
  white-space: nowrap;
}

.select-cantidad {
  flex: 1;
  padding: 4px 6px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 0.85rem;
}


/* ================================
   üìã FORMULARIO DE COMPRA CLIENTE
================================ */
#formularioCliente {
  position: fixed;
  inset: 0;
  background-color: rgba(0, 0, 0, 0.4);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  opacity: 0;
  transform: scale(0.95);
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#formularioCliente.formulario-visible {
  opacity: 1;
  transform: scale(1);
  pointer-events: auto;
}

#formularioCliente form {
  background: #fff;
  padding: 2rem;
  border-radius: 12px;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
}

.campo-formulario {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  margin-bottom: 1rem;
  width: 100%;
}

.campo-formulario label {
  font-weight: bold;
  margin-bottom: 0.4rem;
  color: var(--color-principal);
  font-size: 0.75rem;
}

.campo-formulario input,
.campo-formulario select {
  width: 100%;
  padding: 0.8rem 1rem;
  border: 1px solid #ccc;
  border-radius: 10px;
  font-size: 1rem;
  background-color: #fff;
  transition: border-color 0.3s ease;
}

.campo-formulario input:focus,
.campo-formulario select:focus {
  border-color: var(--color-principal);
  outline: none;
}

#formularioCliente .botones {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-top: 1.5rem;
  align-items: center;
}

#formularioCliente .botones button {
  padding: 0.9rem 2rem;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

#formularioCliente .botones .btn-enviar {
  background-color: var(--color-principal);
  color: white;
}

#formularioCliente .botones .btn-enviar:hover {
  background-color: var(--color-principal-hover, #0056b3);
}

#formularioCliente .botones .btn-cancelar {
  background-color: #ccc;
  color: #333;
}

#formularioCliente .botones .btn-cancelar:hover {
  background-color: #bbb;
}


/* ===================================
   üåô DARK MODE
=================================== */
body.dark-mode .carrito,
body.dark-mode #formularioCliente form {
  background-color: #1e1e1e;
  color: #fff;
  border: 1px solid #333;
}

body.dark-mode .campo-formulario input,
body.dark-mode .campo-formulario select {
  background-color: #2a2a2a;
  border-color: #444;
  color: #f0f0f0;
}

body.dark-mode .campo-formulario input:focus,
body.dark-mode .campo-formulario select:focus {
  border-color: var(--color-secundario);
  box-shadow: 0 0 0 2px rgba(110, 246, 72, 0.2);
}

body.dark-mode button {
  background-color: #333;
  color: #fff;
}

/* ===================================
   üß∞ UTILITARIOS
=================================== */
.oculto {
  display: none !important;
}

.img-mini {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 8px;
}

.notificacion {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #414341;
  color: #fff;
  padding: 1rem 1.5rem;
  border-radius: 8px;
  font-size: 1rem;
  z-index: 9999;
  opacity: 0;
  transition: opacity 0.4s ease;
  max-width: 90vw;
}

.notificacion.mostrar {
  opacity: 1;
}

/* ===================================
   üì± MEDIA QUERIES
=================================== */


@media (max-width: 480px) {
  header {
    height: auto;
    padding: 1rem 0;
  }

  header h1 {
    font-size: 1.5rem;
    max-width: 80%;
  }

  .barra-navegacion {
    flex-direction: row; /* ‚úÖ Siempre horizontal */
    justify-content: center;
    flex-wrap: wrap;
    gap: 0.6rem;
  }

  .barra-navegacion a {
    font-size: 0.95rem;
    white-space: nowrap;
  }

  .main-img {
  height: 100%;  /* ‚úÖ Opcional: asegura que ocupe todo el contenedor */

  }

  .talla-item,
  .color-item {
    font-size: 0.85rem;
    padding: 0.5rem 0.8rem;
  }

  .btn-agregar {
    font-size: 1rem;
    padding: 0.85rem 1.2rem;
    max-width: 95%;
  }
}

#quienes-somos {
  max-width: 900px;
  margin: 1rem auto;
  padding: 1rem;
  background-color: var(--gris-claro);
  border-radius: var(--borde-radius);
  box-shadow: var(--sombra-suave);
  color: var(--color-texto);
  font-family: 'Segoe UI', sans-serif;
  line-height: 1.6;
  overflow-wrap: break-word; /* üëâ evita que palabras largas rompan el dise√±o */
  word-break: break-word;
  box-sizing: border-box;
}

#quienes-somos h2 {
  font-size: 1.8rem;
  margin-bottom: 1rem;
  color: var(--color-negro);
  text-align: center;
}

#contenido-quienes-somos {
  font-size: 1.1rem;
  text-align: justify;
  white-space: pre-wrap; /* üëâ mantiene saltos de l√≠nea y se adapta */
  overflow-wrap: break-word;
  word-break: break-word;
}


@media (max-width: 600px) {
  #quienes-somos {
    padding: 1.2rem;
  }

  #quienes-somos h2 {
    font-size: 1.5rem;
  }

  #contenido-quienes-somos {
    font-size: 1rem;
  }
}

.bloque-carrito,
.bloque-formulario {
  background-color: #ffffff;
  padding: 1.5rem;
  border-radius: 18px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  margin-top: 1.5rem;
}
.bloque-formulario {
  background-color: #fdfdfd;
  border: 1px solid #ddd;
}


.bloque-carrusel {
  background-color: #fff;
  padding: 1rem;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  max-width: 900px;
  margin: auto;
  overflow: hidden;
}

.carrusel-infinito {
  display: flex;
  gap: 10px;
  animation: scrollInfinite 20s linear infinite;
}

.miniatura {
  width: 50px;
  height: 50px;
  border-radius: 8px;
  object-fit: cover;
  flex-shrink: 0;
  transition: transform 0.2s ease;
}

.miniatura:hover {
  transform: scale(1.08);
}

.descripcion-general {
  margin-top: 1rem;
    white-space: pre-wrap; /* üëâ mantiene saltos de l√≠nea y se adapta */

}

@keyframes scrollInfinite {
  0%   { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}


 </style>
<body>

<!-- Encabezado -->
<header id="inicio" onclick="irAInicio()" style="cursor: pointer;">
  <h1>Moda & Estilo</h1>
</header>

  
 <!-- Navegaci√≥n -->
  <nav class="barra-navegacion">
    <a href="#inicio">Inicio</a>
    <a href="#quienes-somos">Nosotros</a>
    <a href="#footer">Cont√°ctanos</a>
  </nav>

<!-- Buscador -->
<div id="bloque-buscador">
  <div class="contenedor-buscador">
    <i class="fas fa-search icono-lupa"></i>
    <input type="text" id="buscadorProductos" placeholder="Buscar productos...">
  </div>
</div>

<div style="height: 30px;"></div>
<div id="notificacion" class="notificacion oculto">Agregado</div>


<!-- Bot√≥n que despliega TODO -->
<div class="fila-carrito">
  <button class="btn-azul icono-carrito-fijo" onclick="toggleCarrito()">üõí</button>
</div>

<!-- Contenedor de todo: carrito, total, botones y formulario -->
<div id="bloqueCarrito" class="container">
  <span class="cerrar-carrito" onclick="toggleCarrito()">üõí</span>

  <div id="carrito"></div>
  <div id="total-carrito"></div>

  <!-- Bot√≥n Finalizar compra -->
  <div style="text-align:center; margin-top: 1rem;">
    <button class="btn-verde" onclick="mostrarFormulario()">‚úÖ Finalizar compra</button>
  </div>

  <!-- Formulario de cliente (modal) -->
  <div id="formularioCliente">
    <div id="formularioContenido">
      <form onsubmit="event.preventDefault(); confirmarEnvioWhatsApp();">

        <div class="campo-formulario">
          <label for="nombreCliente">üë§ Nombre completo</label>
          <input id="nombreCliente" type="text" required />
        </div>

        <div class="campo-formulario">
          <label for="departamentoCliente">üèõÔ∏è Departamento</label>
          <input id="departamentoCliente" type="text" required />
        </div>

        <div class="campo-formulario">
          <label for="ciudadCliente">üèôÔ∏è Ciudad</label>
          <input id="ciudadCliente" type="text" required />
        </div>

        <div class="campo-formulario">
          <label for="direccionCliente">üè† Direcci√≥n</label>
          <input id="direccionCliente" type="text" required />
        </div>

        <div class="campo-formulario">
          <label for="celularCliente">üìû Celular</label>
          <input id="celularCliente" type="tel" pattern="[0-9]{10}" placeholder="Ej: 3111234567" maxlength="10" required />
        </div>

        <div class="campo-formulario">
          <label for="metodoPagoCliente">üí≥ Selecciona tu m√©todo de pago</label>
          <select id="metodoPagoCliente" required>
            <option value="">Selecciona una opci√≥n</option>
          </select>
        </div>

        <div class="botones">
          <button type="submit" class="btn-verde">üì≤ Enviar pedido por WhatsApp</button>
          <button type="button" class="btn-gris" onclick="ocultarFormulario()">üîô Volver</button>
        </div>

      </form>
    </div>
  </div>
</div>


<div id="contenedor-productos" class="grid-productos"></div>




<section id="quienes-somos">
  <h2>Qui√©nes somos</h2>
  <p id="contenido-quienes-somos">Cargando informaci√≥n...</p>
</section>



  <div class="bloque-carrusel">
  <div class="carrusel-ventana">
    <div class="carrusel-infinito contenedor-carrusel" id="carruselGaleria">
      <!-- Se llenar√° din√°micamente -->
    </div>
  </div>

  <div class="descripcion-general">
    <p id="textoGaleria"></p>
  </div>
</div>


   <footer id="footer"style="text-align: center; padding: 1rem; background: #2d3b49; color: white;">
    <div style="font-size: 1.8rem;">
      <a href="#" target="_blank" class="facebook-link" style="margin: 0 10px; color: #0e54eb;">
        <i class="fab fa-facebook"></i>
      </a>
      <a href="#" target="_blank" class="instagram-link" style="margin: 0 10px; color: #e1306c;">
        <i class="fab fa-instagram"></i>
      </a>
      <a href="#" target="_blank" class="tiktok-link" style="margin: 0 10px; color: #000000;">
        <i class="fab fa-tiktok"></i>
      </a>
    </div>
    <div style="font-size: 0.9rem; color: #ffffff;">
      &copy; 2025 Moda & Estilo. Todos los derechos reservados.
    </div>
  </footer>

<script>
// ‚úÖ Inicializar Firebase
const firebaseConfig = {
  apiKey: "AIzaSyCozJXTEJct407_E6CpjLSK6EOZgk-W8fc",
  authDomain: "modaestil0.firebaseapp.com",
  projectId: "modaestil0",
  storageBucket: "modaestil0.appspot.com",
  messagingSenderId: "277454254263",
  appId: "1:277454254263:web:8de217a8c39e25ad1d1d32"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();


  db.collection("configuracion").doc("footer").get().then(doc => {
  if (doc.exists) {
    const c = doc.data();

    // Guardar el n√∫mero para env√≠os
    window.numeroWspConfig = c.whatsapp;

    // WhatsApp del bot√≥n flotante
    const btnWsp = document.querySelector(".btn-whatsapp");
    if (btnWsp && c.whatsapp) {
      btnWsp.href = `https://wa.me/${c.whatsapp}`;
    }

    // Redes sociales
    if (c.facebook) {
      const fb = document.querySelector(".facebook-link");
      if (fb) fb.href = c.facebook;
    }
    if (c.instagram) {
      const ig = document.querySelector(".instagram-link");
      if (ig) ig.href = c.instagram;
    }
    if (c.tiktok) {
      const tt = document.querySelector(".tiktok-link");
      if (tt) tt.href = c.tiktok;
    }
  } else {
    console.warn("‚ö†Ô∏è No hay configuraci√≥n en Firestore.");
  }
}).catch(error => {
  console.error("‚ùå Error cargando configuraci√≥n:", error);
});


db.collection("contenido").doc("quienesSomos").get().then(doc => {
  if (doc.exists) {
    document.getElementById("contenido-quienes-somos").textContent = doc.data().texto || "";
  }
});
 

    // === main.js ===
   
// Carrito inicial
let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

function actualizarCarrito() {
  const div = document.getElementById('carrito');
  div.innerHTML = '';

  if (carrito.length === 0) {
    div.innerHTML = '<p style="text-align:center; color: #888;">üõí El carrito est√° vac√≠o</p>';
    document.getElementById('total-carrito').innerHTML = '';
    localStorage.setItem('carrito', JSON.stringify(carrito));
    return;
  }

  // Agrupar productos por ID y color
  const grupos = {};
  carrito.forEach(item => {
    const clave = `${item.id}_${item.color}`;
    if (!grupos[clave]) {
      grupos[clave] = {
        nombre: item.nombre,
        color: item.color,
        imagen: item.imagen,
        preciosPorCantidad: item.preciosPorCantidad || null,
        items: []
      };
    }
    grupos[clave].items.push(item);
  });

  let total = 0;
let ahorroTotal = 0;

  Object.values(grupos).forEach(grupo => {
    const cantidad = grupo.items.length;

    let precioGrupoTotal = 0;
    let precioUnitario = 0;

    if (grupo.preciosPorCantidad && cantidad > 1) {
      // ‚úÖ Si hay promociones por cantidad y m√°s de 1 unidad
      const precios = grupo.preciosPorCantidad;
      const cantidades = Object.keys(precios).map(c => parseInt(c)).sort((a, b) => a - b);
      let mejorMatch = cantidades[0];

      cantidades.forEach(cant => {
        if (cantidad >= cant) mejorMatch = cant;
      });

      precioGrupoTotal = parseInt(precios[mejorMatch]);
      precioUnitario = Math.round(precioGrupoTotal / cantidad);
    } else {
      // ‚ùå Sin promoci√≥n ‚Üí usar precio original individual
      precioUnitario = grupo.items[0].precio;
      precioGrupoTotal = precioUnitario * cantidad;
    }

        const precioSinDescuento = grupo.items[0].precio * cantidad;
    total += precioGrupoTotal;

    // Calcular ahorro si hay diferencia
    const ahorroGrupo = precioSinDescuento - precioGrupoTotal;
    if (ahorroGrupo > 0) {
      ahorroTotal += ahorroGrupo;
    }


    // Mostrar cada talla por separado
   grupo.items.forEach(item => {
  const tarjeta = document.createElement('div');
  tarjeta.className = 'item-carrito-elegante';

  const promocionActiva = grupo.preciosPorCantidad && cantidad > 1;

  tarjeta.innerHTML = `
    <div class="carrito-info">
      <div class="info-superior">
        <h4>${grupo.nombre} (1 par)</h4>
      </div>
      <p>üé® Color: <strong>${grupo.color}</strong></p>
      <p class="subitem-talla">
        <span>üìè Talla: <strong>${item.talla}</strong> - üí≤ $${precioUnitario.toLocaleString()}</span>
        <span class="icono-eliminar" onclick="eliminarProducto(event, ${carrito.indexOf(item)})">‚ùå</span>
      </p>
      ${promocionActiva ? `<p style="color: green; font-weight: bold; margin-top: 4px;">üí• Promoci√≥n aplicada</p>` : ''}
    </div>
  `;
  div.appendChild(tarjeta);
});

  });

    document.getElementById('total-carrito').innerHTML = `
    <div class="total-carrito">
      üßæ <strong>Total:</strong> <span>$${total.toLocaleString()}</span><br>
      ${ahorroTotal > 0 ? `<span style="color: green;">üéâ Ahorrastes: $${ahorroTotal.toLocaleString()}</span>` : ''}
    </div>
  `;

  localStorage.setItem('carrito', JSON.stringify(carrito));
}

function eliminarGrupo(nombre, color) {
  carrito = carrito.filter(item => !(item.nombre === nombre && item.color === color));
  actualizarCarrito();
}


function eliminarTalla(id, color, talla) {
  const index = carrito.findIndex(item => item.id === id && item.color === color && item.talla === talla);
  if (index !== -1) {
    carrito.splice(index, 1);
    actualizarCarrito();
  }
}


    function eliminarProducto(event, index) {
  event.stopPropagation(); // üëà Previene que se cierre el carrito
  carrito.splice(index, 1);
  actualizarCarrito();
}

function toggleCarrito() {
  const contenedor = document.getElementById('bloqueCarrito');
  const btn = document.querySelector('.fila-carrito button');
  const estaVisible = contenedor.classList.contains('mostrar');

  if (estaVisible) {
    contenedor.classList.remove('mostrar');
    contenedor.classList.add('oculto');
    document.body.classList.remove('mostrar-carrito');
    btn.textContent = 'üõí';
    btn.classList.remove('ocultar-carrito');
    btn.classList.add('ver-carrito');
  } else {
    contenedor.classList.remove('oculto'); // ‚úÖ QUITA oculto
    contenedor.classList.add('mostrar');
    document.body.classList.add('mostrar-carrito');
    actualizarCarrito();
    btn.textContent = 'üõí';
    btn.classList.remove('ver-carrito');
    btn.classList.add('ocultar-carrito');
  }
}

function mostrarFormulario() {
  if (carrito.length === 0) {
    alert("Tu carrito est√° vac√≠o.");
    return;
  }
  const formContainer = document.getElementById('formularioCliente');
  formContainer.classList.add('formulario-visible'); // ‚úÖ NUEVA CLASE
  formContainer.scrollIntoView({ behavior: 'smooth' });
}


function ocultarFormulario() {
  const form = document.getElementById('formularioCliente');
  form.classList.remove('formulario-visible');
  form.classList.remove('oculto'); // por si qued√≥ activa

  const carrito = document.getElementById('bloqueCarrito');
  carrito.classList.remove('oculto');

  const btn = document.querySelector('.fila-carrito button');
  if (btn) {
    btn.textContent = 'üõí';
    btn.classList.remove('ver-carrito');
    btn.classList.add('ocultar-carrito');
  }
}


// Guardar nuevo contenido
function guardarQuienesSomos() {
  const nuevoTexto = document.getElementById("textarea-quienes-somos").value.trim();
  db.collection("configuracion").doc("quienesSomos").set({ contenido: nuevoTexto })
    .then(() => alert("‚úÖ Secci√≥n 'Qui√©nes somos' actualizada"))
    .catch(err => alert("‚ùå Error al guardar: " + err.message));
}

    function mostrarNotificacion(mensaje = "Producto agregado") {
      const notif = document.getElementById("notificacion");
      notif.textContent = mensaje;
      notif.classList.remove("oculto");
      notif.classList.add("mostrar");
      setTimeout(() => {
        notif.classList.remove("mostrar");
        notif.classList.add("oculto");
      }, 3000);
    }




    function confirmarEnvioWhatsApp() {
  const campos = {
    nombre: document.getElementById('nombreCliente').value.trim(),
    departamento: document.getElementById('departamentoCliente').value.trim(),
    ciudad: document.getElementById('ciudadCliente').value.trim(),
    direccion: document.getElementById('direccionCliente').value.trim(),
    celular: document.getElementById('celularCliente').value.trim(),
    metodo: document.getElementById('metodoPagoCliente').value
  };

  for (const [key, value] of Object.entries(campos)) {
    if (!value) {
      alert('Por favor completa todos los campos del formulario.');
      return;
    }
  }

  if (!/^\d{10}$/.test(campos.celular)) {
    alert('Por favor ingresa un n√∫mero de celular v√°lido de 10 d√≠gitos.');
    return;
  }

  if (carrito.length === 0) {
    alert('Tu carrito est√° vac√≠o.');
    return;
  }

  const fecha = new Date();
  const fechaFormateada = `${fecha.getDate().toString().padStart(2, '0')}/${(fecha.getMonth() + 1).toString().padStart(2, '0')}/${fecha.getFullYear()}`;
  let mensaje = `üì¶ *NUEVO PEDIDO*\n\nüóìÔ∏è *Fecha:* ${fechaFormateada}\n\n`;

 carrito.forEach((item, i) => {
  mensaje += `ü•ø *Producto ${i + 1}*: ${item.nombre} - Color: ${item.color} - Talla: ${item.talla} - Cantidad: ${item.cantidad} par${item.cantidad > 1 ? 'es' : ''} - Total: $${parseInt(item.precio).toLocaleString()}\n`;

});

  const total = carrito.reduce((acc, item) => acc + parseInt(item.precio), 0);
mensaje += `\nüí∞ *Total:* $${total.toLocaleString()}\n\n`;
  mensaje += `üìç *Nombre:* ${campos.nombre}\n`;
  mensaje += `üèõÔ∏è *Departamento:* ${campos.departamento}\n`;
  mensaje += `üèôÔ∏è *Ciudad:* ${campos.ciudad}\n`;
  mensaje += `üè† *Direcci√≥n:* ${campos.direccion}\n`;
  mensaje += `üìû *Celular:* ${campos.celular}\n`;
  mensaje += `üí≥ *M√©todo de pago seleccionado:* ${campos.metodo}\n`;
mensaje += `\nüôå *¬°Gracias por tu compra!* Te contactaremos pronto para coordinar el env√≠o.`;

  const numeroWhatsApp = window.numeroWspConfig || '573185634316';

  // Obtener m√©todos de pago desde Firebase y luego enviar mensaje
    db.collection("metodosPago").get().then(() => {
    const url = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(mensaje)}`;
    window.open(url, '_blank');

    // Limpiar carrito y volver a inicio
    vaciarCarrito();

    // Ocultar formulario y carrito
    document.getElementById('formularioCliente').classList.add('oculto');
    document.getElementById('bloqueCarrito').classList.add('oculto');

    // Cambiar √≠cono del bot√≥n carrito
    const btn = document.querySelector('.fila-carrito button');
    if (btn) {
      btn.textContent = 'üõí';
      btn.classList.remove('ocultar-carrito');
      btn.classList.add('ver-carrito');
    }

    // Mostrar notificaci√≥n de √©xito
    mostrarNotificacion("‚úÖ Pedido enviado con √©xito");

    // Desplazar al inicio
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }).catch(err => {
    console.error("‚ùå Error al cargar m√©todos de pago:", err);
    alert("Hubo un error al obtener los m√©todos de pago.");
  });

}

 // Descuento extra
 function iniciarDescuentoIndividual(productoNode, minutosDescuento = 10) {
  const tieneDescuentoFijo = parseInt(productoNode.getAttribute("data-descuento-fijo"));
  if (tieneDescuentoFijo > 0) {
    const mensajeDescuento = productoNode.querySelector(".descuento-tiempo");
    if (mensajeDescuento) mensajeDescuento.style.display = "none";
    return; // ‚õî No aplicar descuento por tiempo si ya hay descuento fijo
  }

  const id = productoNode.getAttribute("data-id");
  const precioTag = productoNode.querySelector(".precio-producto");
  const precioConDescuento = productoNode.querySelector(".precio-con-descuento");
  const contador = productoNode.querySelector(".contador-individual");
  const mensajeDescuento = productoNode.querySelector(".descuento-tiempo");

  const precioOriginal = parseFloat(precioTag.getAttribute("data-precio-original"));
  const precioBase = parseFloat(precioTag.getAttribute("data-precio"));

  const precioExtraDescuento = Math.round(precioBase * 0.9); // ‚úÖ 10% extra

  let inicio = localStorage.getItem(`descuentoInicio_${id}`);
  if (!inicio) {
    inicio = new Date().getTime();
    localStorage.setItem(`descuentoInicio_${id}`, inicio);
  } else {
    inicio = parseInt(inicio);
  }

  const fin = inicio + minutosDescuento * 60 * 1000;

  const actualizarContador = () => {
    const ahora = new Date().getTime();
    const restante = fin - ahora;

    if (restante > 0) {
      const segundos = Math.floor((restante / 1000) % 60);
      const minutos = Math.floor((restante / 1000 / 60) % 60);
      const horas = Math.floor(restante / 1000 / 60 / 60);

      contador.textContent = `${horas.toString().padStart(2, "0")}:${minutos
        .toString()
        .padStart(2, "0")}:${segundos.toString().padStart(2, "0")}`;

      precioConDescuento.textContent = `$${precioExtraDescuento.toLocaleString()}`;
      precioTag.setAttribute("data-precio", precioExtraDescuento);
    } else {
      clearInterval(intervalo);
      contador.textContent = "00:00:00";
      precioConDescuento.textContent = `$${precioBase.toLocaleString()}`;
      precioTag.setAttribute("data-precio", precioBase);

      if (mensajeDescuento) mensajeDescuento.style.display = "none";

      let tachado = precioTag.querySelector("s");
      if (!tachado) {
        tachado = document.createElement("s");
        precioTag.insertBefore(tachado, precioConDescuento);
      }
      tachado.textContent = `$${precioOriginal.toLocaleString()}`;
    }
  };

  if (mensajeDescuento) mensajeDescuento.style.display = "block";
  actualizarContador();
  const intervalo = setInterval(actualizarContador, 1000);
}


      function actualizar() {
        const ahora = new Date().getTime();
        const distancia = fin - ahora;

        if (distancia <= 0) {
          clearInterval(intervalo);

          // Restaurar precio
          precioConDescuento.textContent = `$${precioBase.toLocaleString()}`;
          precioTag.setAttribute("data-precio", precioBase);

          // Quitar tachado
          const tachado = precioTag.querySelector("s");
          if (tachado) tachado.remove();

          // ‚úÖ Ocultar mensaje
          if (mensajeDescuento) mensajeDescuento.style.display = "none";

          return;
        }

        const horas = Math.floor((distancia % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutos = Math.floor((distancia % (1000 * 60 * 60)) / (1000 * 60));
        const segundos = Math.floor((distancia % (1000 * 60)) / 1000);

        contador.textContent =
          `${horas.toString().padStart(2, '0')}:` +
          `${minutos.toString().padStart(2, '0')}:` +
          `${segundos.toString().padStart(2, '0')}`;
      }

      actualizar();
      const intervalo = setInterval(actualizar, 1000);
    
function cargarProductosDesdeFirebase() {
  const contenedor = document.getElementById("contenedor-productos");
  contenedor.innerHTML = "Cargando productos...";

  db.collection("productos").onSnapshot(snapshot => {
    contenedor.innerHTML = "";

    snapshot.forEach(doc => {
      const p = doc.data();
      const id = doc.id;

      // Validar campos m√≠nimos
      if (p.precio === undefined || !p.imagenes || Object.keys(p.imagenes).length === 0) return;

      // Usar precioOriginal si existe, si no usar el precio normal
      p.precioOriginal = p.precioOriginal || p.precio;

      const porcentaje = parseInt(p.descuento) || 0;
      const precioDescuentoFijo = porcentaje > 0
        ? Math.round(p.precioOriginal * (1 - porcentaje / 100))
        : p.precio;

      const contenedorProducto = document.createElement("div");
      contenedorProducto.className = "producto";
      contenedorProducto.setAttribute("data-id", id);
      contenedorProducto.setAttribute("data-imagenes", JSON.stringify(p.imagenes || {}));
      contenedorProducto.setAttribute("data-descuento-fijo", porcentaje);

      contenedorProducto.innerHTML = `
        <div class="contenedor-img">
          <img class="main-img" src="${Object.values(p.imagenes)[0]}" alt="${p.nombre}">
        </div>

        <div class="imagenes-carrusel carrusel-scroll">
          ${Object.entries(p.imagenes).map(([color, url]) =>
            `<img src="${url}" alt="${color}" class="img-mini" data-color="${color}">`).join("")}
        </div>

        <h2>${p.nombre}</h2>

        <div class="descripcion-expandible">
          <button class="btn-ver-descripcion">Ver descripci√≥n</button>
          <p class="descripcion-texto">${p.descripcion || "Sin descripci√≥n"}</p>
        </div>

        ${
          Object.keys(p.preciosPorCantidad || {}).length > 1
            ? `
          <div class="opciones-cantidad">
            <label for="selectCantidad_${id}">Cantidad:</label>
            <select class="select-cantidad" id="selectCantidad_${id}">
              ${Object.entries(p.preciosPorCantidad)
                .map(([cant, precio]) =>
                  `<option value="${cant}" data-precio="${precio}">${cant} par${cant > 1 ? 'es' : ''} - $${parseInt(precio).toLocaleString()}</option>`
                ).join("")}
            </select>
          </div>` : ''
        }

        <p class="precio-producto" data-precio="${precioDescuentoFijo}" data-precio-original="${p.precioOriginal}">
          Precio: <s>$${parseInt(p.precioOriginal).toLocaleString()}</s>
          <strong class="precio-con-descuento">$${precioDescuentoFijo.toLocaleString()}</strong>
        </p>

        <div class="cuenta-producto descuento-tiempo" style="font-size:0.9rem; margin-top:0.5rem; color: red;">
          ‚è≥ Descuento 10% extra termina en: <span class="contador-individual">00:00:00</span>
        </div>

        <div class="carrusel-colores carrusel-scroll">
          ${(p.colores || Object.keys(p.imagenes)).map(color => `
            <div class="color-item">${color}</div>`).join("")}
        </div>

        <div class="carrusel-tallas carrusel-scroll">
          ${(p.tallas || []).map(talla => `
            <div class="talla-item">${talla}</div>`).join("")}
        </div>

        <button class="btn-agregar">Agregar al carrito</button>
      `;

      contenedor.appendChild(contenedorProducto);

      // Funcionalidades extra
      inicializarCarruselInteractivo(contenedorProducto);
      iniciarDescuentoIndividual(contenedorProducto, 10);

      // Expandir descripci√≥n
      const botonVerDescripcion = contenedorProducto.querySelector(".btn-ver-descripcion");
      const descripcionTexto = contenedorProducto.querySelector(".descripcion-texto");

      if (botonVerDescripcion && descripcionTexto) {
        botonVerDescripcion.addEventListener("click", () => {
          descripcionTexto.classList.toggle("mostrar");
          botonVerDescripcion.textContent = descripcionTexto.classList.contains("mostrar")
            ? "Ocultar descripci√≥n"
            : "Ver descripci√≥n";
        });

        if (!descripcionTexto.textContent.trim()) {
          botonVerDescripcion.style.display = "none";
        }
      }
    });

    if (contenedor.innerHTML.trim() === "") {
      contenedor.innerHTML = "<p>No hay productos disponibles.</p>";
    }
  }, error => {
    console.error("Error cargando productos:", error);
    contenedor.innerHTML = "<p>Error al cargar productos.</p>";
  });
}



document.getElementById("buscadorProductos").addEventListener("input", function () {
  const termino = this.value.toLowerCase().trim();
  const productos = document.querySelectorAll("#contenedor-productos .producto");

  productos.forEach(producto => {
    const nombre = producto.querySelector("h2").textContent.toLowerCase();
    if (nombre.includes(termino)) {
      producto.style.display = "";
    } else {
      producto.style.display = "none";
    }
  });
});


function inicializarCarruselInteractivo(producto) {
  const imagenes = JSON.parse(producto.getAttribute('data-imagenes') || '{}');
  const mainImg = producto.querySelector('.main-img');
  const miniaturas = hacerCarruselInfinito(producto.querySelector('.imagenes-carrusel'), '.img-mini');
  const colores = hacerCarruselInfinito(producto.querySelector('.carrusel-colores'), '.color-item');
  const tallas = hacerCarruselInfinito(producto.querySelector('.carrusel-tallas'), '.talla-item');
  const cantidadSelect = producto.querySelector('.select-cantidad');
  const boton = producto.querySelector('.btn-agregar');
  const nombre = producto.querySelector('h2').textContent;

  let colorSeleccionado = null;
  let tallaSeleccionada = null;

  miniaturas.forEach(img => {
    img.addEventListener('click', () => {
      miniaturas.forEach(i => i.classList.remove('seleccionada'));
      img.classList.add('seleccionada');
      mainImg.setAttribute('src', img.getAttribute('src'));
      centrarElementoEnCarrusel(producto.querySelector('.imagenes-carrusel'), img);
      producto.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    });
  });

  colores.forEach(c => {
    c.addEventListener('click', () => {
      colores.forEach(otro => otro.classList.remove('active'));
      c.classList.add('active');
      colorSeleccionado = c.textContent.trim();
      const imagenSrc = imagenes[colorSeleccionado];
      if (imagenSrc) mainImg.setAttribute('src', imagenSrc);
      mainImg.setAttribute('data-color', colorSeleccionado);
      producto.setAttribute('data-color', colorSeleccionado);
      centrarElementoEnCarrusel(producto.querySelector('.carrusel-colores'), c);
      producto.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    });
  });

  tallas.forEach(t => {
    t.addEventListener('click', () => {
      tallas.forEach(i => i.classList.remove('active'));
      t.classList.add('active');
      tallaSeleccionada = t.textContent.trim();
      centrarElementoEnCarrusel(producto.querySelector('.carrusel-tallas'), t);
    });
  });

  boton.addEventListener('click', () => {
    if (!colorSeleccionado || !tallaSeleccionada) {
      alert("Selecciona color y talla antes de agregar al carrito.");
      return;
    }

    const preciosPorCantidad = {};
    Array.from(cantidadSelect.options).forEach(opt => {
      preciosPorCantidad[parseInt(opt.value)] = parseInt(opt.getAttribute("data-precio"));
    });

    const productoId = producto.getAttribute("data-id");
    const imagen = mainImg.src;

    carrito.push({
      id: productoId,
      nombre,
      color: colorSeleccionado,
      talla: tallaSeleccionada,
      cantidad: 1,
      precio: preciosPorCantidad[1] || parseInt(producto.querySelector('.precio-producto').getAttribute("data-precio")),
      preciosPorCantidad,
      imagen
    });

    localStorage.setItem('carrito', JSON.stringify(carrito));
    actualizarCarrito();
    mostrarNotificacion();
  });
}


    function hacerCarruselInfinito(carrusel, claseItem) {
      const originales = Array.from(carrusel.querySelectorAll(claseItem));
      const total = originales.length;
      if (total <= 1) return originales;

      // ‚úÖ Duplica 10 veces para dar efecto de cinta
      let clones = [];
      for (let i = 0; i < 9; i++) {
        originales.forEach(item => {
          const clon = item.cloneNode(true);
          clon.classList.add("clon");
          clones.push(clon);
        });
      }

      carrusel.innerHTML = '';
      clones.forEach(n => carrusel.appendChild(n));

      // No se fuerza scrollLeft: dejamos que el usuario lo controle
      return Array.from(carrusel.querySelectorAll(claseItem));
    }


    function actualizarActivoCentral(carrusel, claseItem) {
      const items = Array.from(carrusel.querySelectorAll(claseItem));

      // Si el usuario ya seleccion√≥ manualmente, no forzar
      const seleccionado = items.find(i => i.classList.contains("active") && !i.classList.contains("clon"));
      if (seleccionado) return;

      const centro = carrusel.scrollLeft + carrusel.offsetWidth / 2;
      let mejor = null;
      let menor = Infinity;

      items.forEach(item => {
        const centroItem = item.offsetLeft + item.offsetWidth / 2;
        const distancia = Math.abs(centro - centroItem);
        if (distancia < menor) {
          menor = distancia;
          mejor = item;
        }
      });

      if (mejor) {
        items.forEach(i => i.classList.remove("active"));
        mejor.classList.add("active");
      }
    }


    function centrarElementoEnCarrusel(carrusel, elemento) {
      const items = Array.from(carrusel.querySelectorAll(`.${elemento.classList[0]}`));

      // Buscar el clon m√°s cercano visualmente al centro del carrusel
      const centroCarrusel = carrusel.scrollLeft + carrusel.offsetWidth / 2;

      let mejor = elemento;
      let menorDistancia = Infinity;

      items.forEach(item => {
        if (item.textContent.trim() !== elemento.textContent.trim()) return;

        const centroItem = item.offsetLeft + item.offsetWidth / 2;
        const distancia = Math.abs(centroItem - centroCarrusel);

        if (distancia < menorDistancia) {
          menorDistancia = distancia;
          mejor = item;
        }
      });

      const carruselRect = carrusel.getBoundingClientRect();
      const elemRect = mejor.getBoundingClientRect();
      const offset = elemRect.left - carruselRect.left - carrusel.offsetWidth / 2 + elemRect.width / 2;

      carrusel.scrollTo({
        left: carrusel.scrollLeft + offset,
        behavior: 'smooth'
      });
    }

  function cargarMetodosPagoPublico() {
  const lista = document.getElementById('listaMetodosPagoPublico');
  if (!lista) return;

  db.collection("metodosPago").onSnapshot(snapshot => {
    lista.innerHTML = "";
    snapshot.forEach(doc => {
      const metodo = doc.data();
      const li = document.createElement("li");
      li.textContent = `${metodo.nombre}: ${metodo.cuenta}`;
      lista.appendChild(li);
    });
  });
}

function cargarOpcionesMetodoPago() {
  const select = document.getElementById("metodoPagoCliente");

  // Limpiar opciones anteriores (excepto la primera)
  while (select.options.length > 1) {
    select.remove(1);
  }

  db.collection("metodosPago").get().then(snapshot => {
    snapshot.forEach(doc => {
      const metodo = doc.data();
      const opcion = document.createElement("option");
      opcion.value = `${metodo.nombre} - ${metodo.cuenta}`;
      opcion.textContent = `${metodo.nombre} - ${metodo.cuenta}`;
      select.appendChild(opcion);
    });
  });
}


function cargarGaleriaDesdeFirebase() {
  const carrusel = document.getElementById('carruselGaleria');
  const descripcion = document.getElementById('textoGaleria');

  db.collection('galeria').doc('principal').get().then(doc => {
    if (!doc.exists) return;

    const data = doc.data();
    descripcion.textContent = data.descripcion || "";

    // Agregar im√°genes duplicadas para scroll infinito
    const imagenes = [...data.imagenes, ...data.imagenes];
    carrusel.innerHTML = imagenes.map(url => `
      <img src="${url}" class="miniatura" alt="galer√≠a">
    `).join('');
  });
}


  function irAInicio() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }    

  // Exponer funciones al HTML (onclick)
window.mostrarFormulario = mostrarFormulario;
window.ocultarFormulario = ocultarFormulario;
window.confirmarEnvioWhatsApp = confirmarEnvioWhatsApp;



window.addEventListener("DOMContentLoaded", () => {
  actualizarCarrito();
  cargarProductosDesdeFirebase();
   cargarMetodosPagoPublico(); // ‚úÖ Aqu√≠
cargarOpcionesMetodoPago();
cargarGaleriaDesdeFirebase();

document.addEventListener("click", (event) => {
  const formulario = document.getElementById("formularioCliente");
  const contenidoFormulario = formulario?.querySelector("form");
  const carrito = document.getElementById("bloqueCarrito");
  const btnToggle = document.querySelector(".fila-carrito button");

  if (!formulario || !carrito || !btnToggle) return;

  const hizoClickEnFormulario = contenidoFormulario?.contains(event.target);
  const hizoClickEnCarrito = carrito.contains(event.target);
  const hizoClickEnBoton = btnToggle.contains(event.target);
  const hizoClickEnEliminar = event.target.classList.contains("icono-eliminar");

  // Cierra el FORMULARIO si est√° visible y se hace clic fuera
  if (
    formulario.classList.contains("formulario-visible") &&
    !hizoClickEnFormulario &&
    !hizoClickEnBoton &&
    !hizoClickEnCarrito
  ) {
    formulario.classList.remove("formulario-visible");
    carrito.classList.remove("oculto");
  }

  // Cierra el CARRITO si est√° visible y se hace clic fuera
  if (
    carrito.classList.contains("mostrar") &&
    !hizoClickEnCarrito &&
    !hizoClickEnBoton &&
    !hizoClickEnEliminar
  ) {
    carrito.classList.remove("mostrar");
    carrito.classList.add("oculto");
    btnToggle.textContent = "üõí";
    btnToggle.classList.remove("ocultar-carrito");
    btnToggle.classList.add("ver-carrito");
  }
});

});


</script>

</body>
</html>
